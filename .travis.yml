notifications:
  email: false
  hipchat:
    rooms:
      secure: "QzAubhCvpG9psLesRct1IL3LLp1QGm/NS+sPOnXc839WMv+4cYpQucjW5B9QdoKVR3fuJUlsTuHOQXRxSWcv2M67YZHnZZQeVnO8ThLU5G73YG427ZF5V63MIFbZfB0cn+JUnjR9XGbbnW0i5zKisfADt5GqCT852ZJWEgNA2K4="
    template:
      - '%{repository}#%{build_number} (%{branch} - %{commit} : %{author}): %{message}'
    notify: true
before_install:
  - sudo service postgresql stop
  - sudo rm -rf /var/lib/postgresql
  - sudo apt-get remove --purge postgresql postgresql-9.1 postgresql-9.2 postgresql-9.3 postgresql-9.4 postgresql-common
  - sudo apt-get autoremove
install:
  - sudo apt-get install python-pip git
  - sudo pip install paramiko PyYAML Jinja2 httplib2
  - git clone --branch v1.9.2-0.1.rc1 --depth 1 --recursive https://github.com/ansible/ansible.git ~/ansible
  - cd ~/ansible; sudo python setup.py install; cd -
before_script:
  - sed -i 's/all/127.0.0.1/' playbook.yml
  - sed -i 's/vagrant/travis/' playbook.yml
  - sed -i 's/trusty/precise/' roles/postgresql/tasks/install.yml
  - cp .travis.supervisor.init roles/supervisor/files/supervisor
script:
  - PYTHONUNBUFFERED=1 ANSIBLE_FORCE_COLOR=true ansible-playbook playbook.yml --connection=local -i 'localhost,'
